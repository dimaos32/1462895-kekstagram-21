{"version":3,"sources":["webpack://kekstagram/./js/utils.js","webpack://kekstagram/./js/backend.js","webpack://kekstagram/./js/pictures.js","webpack://kekstagram/./js/effects.js","webpack://kekstagram/./js/edit-form.js","webpack://kekstagram/./js/filter.js","webpack://kekstagram/./js/main.js"],"names":["qEndingsMap","symbol","window","utils","Key","ENTER","ESCAPE","checkExtensionAccordance","file","arr","some","ending","name","toLowerCase","endsWith","getQEndings","q","word","getRandomArrayElements","n","copySource","slice","randomArray","i","length","element","Math","floor","random","push","swap","addId","array","map","item","Object","assign","id","debounce","cb","interval","lastTimeout","args","clearTimeout","setTimeout","API_URL","makeRequest","method","url","onSuccess","onError","data","xhr","XMLHttpRequest","responseType","timeout","open","send","addEventListener","status","response","statusText","backend","load","page","document","querySelector","comunityPhotos","photoDetails","commentsShown","commentsCount","commentsList","commentsLoader","photoDetailsClose","photoTemplate","content","commentTemplate","evt","target","closest","preventDefault","photo","photos","find","comments","description","likes","addComment","comment","cloneNode","src","avatar","alt","textContent","message","append","loadCommentsPortion","commentsLoaded","parseInt","commentsTotal","commentsToLoad","classList","add","onCommentsLoaderClick","closePhoto","remove","removeEventListener","onPhotoDetailsCloseClick","onPhotoDetailsEscPress","key","innerHTML","openPhoto","dataset","onPhotoClick","pictures","renderPhotos","fragment","createDocumentFragment","querySelectorAll","forEach","photoPreset","renderPhoto","PIN_POS_MAX","photoEditForm","photoPreview","effectsList","effectNone","effectLevelBar","effectLevelValue","effectLevelPin","effectLevelDepth","pinPos","currentEffect","effects","none","className","style","filter","chrome","depth","depthAbsolute","sepia","marvin","phobos","round","heat","resetPinPos","left","width","value","display","startCoord","clientX","onMouseMove","moveEvt","shift","onMouseUp","upEvt","resetValue","reset","checked","RE_HASHTAG","pageContent","photoUploadForm","photoUploadFormCancel","scaleControlSmaller","scaleControlBigger","scaleControlValue","photoDescription","photoHashtags","templateSuccessMessage","templateErrorMessage","resizePhoto","scale","resetForm","onSendResult","template","onClick","onEscPress","onSendSuccess","onSendError","activeElement","scaleValue","getDownScale","getUpScale","validity","str","hashtags","trim","split","sort","reason","test","checkHashtags","setCustomValidity","reportValidity","valueLength","extraSymbols","FormData","filterPhotos","right","FILE_TYPES","photoUploadFormInput","node","createElement","body","insertAdjacentElement","files","reader","FileReader","result","readAsDataURL"],"mappings":"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","file":"main_bundle.js","sourcesContent":["'use strict';\n\nconst DEBOUNCE_INTERVAL = 500;\n\nconst Key = {\n  ENTER: `Enter`,\n  ESCAPE: `Escape`,\n};\n\nconst qEndingsMap = {\n  symbol: [`символ`, `символа`, `символов`],\n};\n\nconst checkExtensionAccordance = (file, arr) => {\n  return arr.some((ending) => {\n    return file.name.toLowerCase().endsWith(ending);\n  });\n};\n\nconst getQEndings = (q = 1, word) => {\n  if (q % 100 < 11 || q % 100 > 14) {\n    if (q % 10 === 1) {\n      return `${q} ${qEndingsMap[word][0]}`;\n    } else if (q % 10 > 1 && q % 10 < 5) {\n      return `${q} ${qEndingsMap[word][1]}`;\n    }\n  }\n\n  return `${q} ${qEndingsMap[word][2]}`;\n};\n\nconst getRandomArrayElements = (arr, n = 1) => {\n  let copySource = arr.slice();\n  let randomArray = [];\n\n  for (let i = 0; i < copySource.length && i < n; i++) {\n    const element = i + Math.floor(Math.random() * (copySource.length - i));\n    randomArray.push(copySource[element]);\n    const swap = copySource[element];\n    copySource[element] = copySource[i];\n    copySource[i] = swap;\n  }\n\n  return randomArray;\n};\n\nconst addId = (array) => {\n  return array.map((item, i) => {\n    return Object.assign({}, item, {id: `${i}`});\n  });\n};\n\nconst debounce = (cb, interval = DEBOUNCE_INTERVAL) => {\n  let lastTimeout = null;\n\n  return function (...args) {\n\n    if (lastTimeout) {\n      window.clearTimeout(lastTimeout);\n    }\n\n    lastTimeout = window.setTimeout(() => {\n      cb(...args);\n    }, interval);\n  };\n};\n\nwindow.utils = {\n  Key,\n  checkExtensionAccordance,\n  getQEndings,\n  getRandomArrayElements,\n  addId,\n  debounce,\n};\n","'use strict';\n\nconst MILISECONDS_IN_SECOND = 1000;\n\nconst API_URL = `https://21.javascript.pages.academy/kekstagram`;\n\nconst StatusCode = {\n  OK: 200\n};\n\nconst TIMEOUT = 10000;\n\nconst makeRequest = (method, url, onSuccess, onError, data) => {\n  const xhr = new XMLHttpRequest();\n  xhr.responseType = `json`;\n  xhr.timeout = TIMEOUT;\n\n  xhr.open(method, url);\n  if (method === `POST`) {\n    xhr.send(data);\n  } else {\n    xhr.send();\n  }\n\n  xhr.addEventListener(`load`, () => {\n    if (xhr.status === StatusCode.OK) {\n      onSuccess(xhr.response);\n    } else {\n      onError(`Статус ответа: ${xhr.status} ${xhr.statusText}`);\n    }\n  });\n\n  xhr.addEventListener(`error`, () => {\n    onError(`Произошла ошибка соединения`);\n  });\n\n  xhr.addEventListener(`timeout`, () => {\n    onError(`Запрос не успел выполниться за ${xhr.timeout / MILISECONDS_IN_SECOND} с`);\n  });\n};\n\nconst load = (onSuccess, onError) => {\n  makeRequest(`GET`, `${API_URL}/data`, onSuccess, onError);\n};\n\nconst send = (data, onSuccess, onError) => {\n  makeRequest(`POST`, API_URL, onSuccess, onError, data);\n};\n\nwindow.backend = {\n  load,\n  send,\n};\n","'use strict';\n\nconst COMMENTS_TO_LOAD_MAX = 5;\n\nconst page = document.querySelector(`body`);\nconst comunityPhotos = document.querySelector(`.pictures`);\nconst photoDetails = document.querySelector(`.big-picture`);\nconst commentsShown = photoDetails.querySelector(`.comments-shown`);\nconst commentsCount = photoDetails.querySelector(`.comments-count`);\nconst commentsList = photoDetails.querySelector(`.social__comments`);\nconst commentsLoader = photoDetails.querySelector(`.social__comments-loader`);\nconst photoDetailsClose = photoDetails.querySelector(`.big-picture__cancel`);\nconst photoTemplate = document.querySelector(`#picture`)\n  .content\n  .querySelector(`.picture`);\nconst commentTemplate = document.querySelector(`#social__comment`)\n  .content\n  .querySelector(`.social__comment`);\n\nconst renderPhoto = (item) => {\n  const photoPreset = photoTemplate.cloneNode(true);\n\n  photoPreset.dataset.id = item.id;\n  photoPreset.querySelector(`.picture__img`).src = item.url;\n  photoPreset.querySelector(`.picture__img`).alt = item.description;\n  photoPreset.querySelector(`.picture__comments`).textContent = `${item.comments.length}`;\n  photoPreset.querySelector(`.picture__likes`).textContent = `${item.likes}`;\n\n  return photoPreset;\n};\n\nconst deletePhotos = () => {\n  const photos = comunityPhotos.querySelectorAll(`.picture`);\n\n  photos.forEach((photo) => {\n    photo.remove();\n  });\n};\n\nconst renderPhotos = (data) => {\n  const fragment = document.createDocumentFragment();\n\n  deletePhotos();\n\n  data.forEach((photo) => {\n    fragment.append(renderPhoto(photo));\n  });\n\n  comunityPhotos.append(fragment);\n};\n\nconst openPhoto = (id) => {\n  const photo = window.photos.find((item) => item.id === id);\n  const {comments, description, likes, url} = photo;\n\n  const addComment = (n) => {\n    const comment = commentTemplate.cloneNode(true);\n    comment.querySelector(`.social__picture`).src = comments[n].avatar;\n    comment.querySelector(`.social__picture`).alt = comments[n].name;\n    comment.querySelector(`.social__text`).textContent = comments[n].message;\n\n    commentsList.append(comment);\n  };\n\n  const loadCommentsPortion = () => {\n    const commentsLoaded = parseInt(commentsShown.textContent, 10);\n    const commentsTotal = parseInt(commentsCount.textContent, 10);\n    const commentsToLoad = commentsTotal - commentsLoaded < COMMENTS_TO_LOAD_MAX\n      ? commentsTotal - commentsLoaded\n      : COMMENTS_TO_LOAD_MAX;\n\n    for (let i = commentsLoaded; i < commentsLoaded + commentsToLoad; i++) {\n      addComment(i);\n    }\n\n    commentsShown.textContent = `${commentsLoaded + commentsToLoad}`;\n\n    if (commentsShown.textContent === commentsCount.textContent) {\n      commentsLoader.classList.add(`hidden`);\n    }\n  };\n\n  const onCommentsLoaderClick = () => {\n    loadCommentsPortion();\n  };\n\n  const closePhoto = () => {\n    photoDetails.classList.add(`hidden`);\n    page.classList.remove(`modal-open`);\n    commentsLoader.classList.remove(`hidden`);\n\n    commentsLoader.removeEventListener(`click`, onCommentsLoaderClick);\n    photoDetailsClose.removeEventListener(`click`, onPhotoDetailsCloseClick);\n    document.removeEventListener(`keydown`, onPhotoDetailsEscPress);\n  };\n\n  const onPhotoDetailsCloseClick = () => {\n    closePhoto();\n  };\n\n  const onPhotoDetailsEscPress = (evt) => {\n    if (evt.key === window.utils.Key.ESCAPE) {\n      evt.preventDefault();\n      closePhoto();\n    }\n  };\n\n  photoDetails.querySelector(`.big-picture__img img`).src = url;\n  photoDetails.querySelector(`.social__caption`).textContent = description;\n  photoDetails.querySelector(`.likes-count`).textContent = `${likes}`;\n\n  commentsShown.textContent = 0;\n  commentsCount.textContent = `${comments.length}`;\n  commentsList.innerHTML = ``;\n\n  loadCommentsPortion();\n\n  photoDetails.classList.remove(`hidden`);\n  page.classList.add(`modal-open`);\n\n  commentsLoader.addEventListener(`click`, onCommentsLoaderClick);\n  photoDetailsClose.addEventListener(`click`, onPhotoDetailsCloseClick);\n  document.addEventListener(`keydown`, onPhotoDetailsEscPress);\n};\n\nconst onPhotoClick = (evt) => {\n  if (evt.target.closest(`.picture`)) {\n    evt.preventDefault();\n    openPhoto(evt.target.closest(`.picture`).dataset.id);\n  }\n};\n\ncomunityPhotos.addEventListener(`click`, (evt) => {\n  onPhotoClick(evt);\n});\n\nwindow.pictures = {\n  renderPhotos,\n};\n","'use strict';\n\nconst BAR_WIDTH = 453;\nconst PIN_POS_MIN = 0;\nconst PIN_POS_MAX = 100;\n\nconst Limit = {\n  CHROME_MIN: 0,\n  CHROME_MAX: 1,\n  SEPIA_MIN: 0,\n  SEPIA_MAX: 1,\n  MARVIN_MIN: 0,\n  MARVIN_MAX: 100,\n  PHOBOS_MIN: 0,\n  PHOBOS_MAX: 3,\n  HEAT_MIN: 1,\n  HEAT_MAX: 3,\n};\n\nconst photoEditForm = document.querySelector(`.img-upload__overlay`);\nconst photoPreview = photoEditForm.querySelector(`.img-upload__preview img`);\nconst effectsList = photoEditForm.querySelector(`.effects__list`);\nconst effectNone = photoEditForm.querySelector(`#effect-none`);\nconst effectLevelBar = photoEditForm.querySelector(`.effect-level`);\nconst effectLevelValue = photoEditForm.querySelector(`.effect-level__value`);\nconst effectLevelPin = photoEditForm.querySelector(`.effect-level__pin`);\nconst effectLevelDepth = photoEditForm.querySelector(`.effect-level__depth`);\n\nlet currentEffect = `none`;\nlet pinPos;\n\nconst effects = {\n  none: () => {\n    photoPreview.className = ``;\n    photoPreview.style.filter = ``;\n  },\n  chrome: (depth) => {\n    const depthAbsolute = Limit.CHROME_MIN + (Limit.CHROME_MAX - Limit.CHROME_MIN) * depth / PIN_POS_MAX;\n\n    photoPreview.className = `effects__preview--chrome`;\n    photoPreview.style.filter = `grayscale(${depthAbsolute})`;\n  },\n  sepia: (depth) => {\n    const depthAbsolute = Limit.SEPIA_MIN + (Limit.SEPIA_MAX - Limit.SEPIA_MIN) * depth / PIN_POS_MAX;\n\n    photoPreview.className = `effects__preview--sepia`;\n    photoPreview.style.filter = `sepia(${depthAbsolute})`;\n  },\n  marvin: (depth) => {\n    const depthAbsolute = Limit.MARVIN_MIN + (Limit.MARVIN_MAX - Limit.MARVIN_MIN) * depth / PIN_POS_MAX;\n\n    photoPreview.className = `effects__preview--marvin`;\n    photoPreview.style.filter = `invert(${depthAbsolute}%)`;\n  },\n  phobos: (depth) => {\n    const depthAbsolute = Math.round(Limit.PHOBOS_MIN + (Limit.PHOBOS_MAX - Limit.PHOBOS_MIN) * depth / PIN_POS_MAX);\n\n    photoPreview.className = `effects__preview--phobos`;\n    photoPreview.style.filter = `blur(${depthAbsolute}px)`;\n  },\n  heat: (depth) => {\n    const depthAbsolute = Limit.HEAT_MIN + (Limit.HEAT_MAX - Limit.HEAT_MIN) * depth / PIN_POS_MAX;\n\n    photoPreview.className = `effects__preview--heat`;\n    photoPreview.style.filter = `brightness(${depthAbsolute})`;\n  },\n};\n\nconst resetPinPos = () => {\n  pinPos = PIN_POS_MAX;\n  effectLevelPin.style.left = `${PIN_POS_MAX}%`;\n  effectLevelDepth.style.width = effectLevelPin.style.left;\n};\n\neffectsList.addEventListener(`change`, (evt) => {\n  resetPinPos();\n  currentEffect = evt.target.value;\n  effects[currentEffect](pinPos);\n  effectLevelBar.style.display = `block`;\n\n  if (currentEffect === `none`) {\n    effectLevelBar.style.display = `none`;\n  }\n});\n\nconst resetEffects = () => {\n  effectNone.checked = true;\n};\n\neffectLevelPin.addEventListener(`mousedown`, (evt) => {\n  evt.preventDefault();\n\n  let startCoord = evt.clientX;\n\n  const onMouseMove = (moveEvt) => {\n    moveEvt.preventDefault();\n\n    const shift = moveEvt.clientX - startCoord;\n\n    startCoord = moveEvt.clientX;\n\n    pinPos += (shift * PIN_POS_MAX / BAR_WIDTH);\n\n    if (pinPos < PIN_POS_MIN) {\n      pinPos = PIN_POS_MIN;\n    }\n\n    if (pinPos > PIN_POS_MAX) {\n      pinPos = PIN_POS_MAX;\n    }\n\n    effects[currentEffect](pinPos);\n\n    effectLevelPin.style.left = `${pinPos}%`;\n    effectLevelDepth.style.width = effectLevelPin.style.left;\n  };\n\n  const onMouseUp = (upEvt) => {\n    upEvt.preventDefault();\n\n    effectLevelValue.value = Math.round(pinPos);\n\n    document.removeEventListener(`mousemove`, onMouseMove);\n    document.removeEventListener(`mouseup`, onMouseUp);\n  };\n\n  document.addEventListener(`mousemove`, onMouseMove);\n  document.addEventListener(`mouseup`, onMouseUp);\n});\n\nwindow.effects = {\n  resetValue: resetPinPos,\n  reset: resetEffects,\n};\n","'use strict';\n\nconst SCALE_MIN = 25;\nconst SCALE_MAX = 100;\nconst SCALE_STEP = 25;\n\nconst PERСENTS_DEFAULT = 100;\n\nconst MAX_TITLE_LENGTH = 140;\n\nconst HASHTAGS_MAX_QUANTITY = 5;\nconst RE_HASHTAG = /^#[\\wА-Яа-я]{1,19}$/;\n\nconst page = document.querySelector(`body`);\nconst pageContent = page.querySelector(`main`);\nconst photoUploadForm = document.querySelector(`.img-upload__form`);\nconst photoEditForm = photoUploadForm.querySelector(`.img-upload__overlay`);\nconst photoUploadFormCancel = photoEditForm.querySelector(`#upload-cancel`);\nconst scaleControlSmaller = photoEditForm.querySelector(`.scale__control--smaller`);\nconst scaleControlBigger = photoEditForm.querySelector(`.scale__control--bigger`);\nconst scaleControlValue = photoEditForm.querySelector(`.scale__control--value`);\nconst photoPreview = photoEditForm.querySelector(`.img-upload__preview img`);\nconst photoDescription = photoEditForm.querySelector(`.text__description`);\nconst photoHashtags = photoEditForm.querySelector(`.text__hashtags`);\nconst templateSuccessMessage = document.querySelector(`#success`)\n  .content\n  .querySelector(`.success`);\nconst templateErrorMessage = document.querySelector(`#error`)\n  .content\n  .querySelector(`.error`);\n\nconst closePhotoEditForm = () => {\n  photoUploadForm.reset();\n  photoEditForm.classList.add(`hidden`);\n  page.classList.remove(`modal-open`);\n};\n\nconst resizePhoto = (scale = 1) => {\n  photoPreview.style = `transform: scale(${scale}`;\n};\n\nconst getDownScale = () => {\n  const scaleValue = parseInt(scaleControlValue.value, 10);\n  if (scaleValue > SCALE_MIN) {\n    scaleControlValue.value = `${scaleValue - SCALE_STEP}%`;\n    resizePhoto((scaleValue - SCALE_STEP) / PERСENTS_DEFAULT);\n  }\n};\n\nconst getUpScale = () => {\n  const scaleValue = parseInt(scaleControlValue.value, 10);\n  if (scaleValue < SCALE_MAX) {\n    scaleControlValue.value = `${scaleValue + SCALE_STEP}%`;\n    resizePhoto((scaleValue + SCALE_STEP) / PERСENTS_DEFAULT);\n  }\n};\n\nconst checkHashtags = (str) => {\n  const hashtags = str.trim().toLowerCase().split(` `).sort();\n\n  if (hashtags.length > HASHTAGS_MAX_QUANTITY) {\n    return {value: false, reason: `QUANTITY`};\n  }\n\n  for (let i = 0; i < hashtags.length; i++) {\n    if (!RE_HASHTAG.test(hashtags[i]) && str) {\n      return {value: false, reason: `RE`};\n    }\n\n    if (i > 0 && hashtags[i] === hashtags[i - 1]) {\n      return {value: false, reason: `DOUBLING`};\n    }\n  }\n\n  return {value: true};\n};\n\nconst resetForm = () => {\n  resizePhoto();\n  scaleControlValue.value = `100%`;\n  window.effects.resetValue();\n  window.effects.reset();\n  photoPreview.className = ``;\n  photoPreview.style.filter = ``;\n  photoDescription.value = ``;\n  photoHashtags.value = ``;\n  closePhotoEditForm();\n};\n\nconst onSendResult = (template) => {\n  const message = template.cloneNode(true);\n\n  const onClick = () => {\n    message.remove();\n\n    message.removeEventListener(`click`, onClick);\n    document.removeEventListener(`keydown`, onEscPress);\n  };\n\n  const onEscPress = (evt) => {\n    if (evt.key === window.utils.Key.ESCAPE) {\n      message.remove();\n      document.removeEventListener(`keydown`, onEscPress);\n    }\n  };\n\n  resetForm();\n\n  pageContent.append(message);\n\n  message.addEventListener(`click`, onClick);\n  document.addEventListener(`keydown`, onEscPress);\n};\n\nconst onSendSuccess = () => {\n  onSendResult(templateSuccessMessage);\n};\n\nconst onSendError = () => {\n  onSendResult(templateErrorMessage);\n};\n\nphotoUploadFormCancel.addEventListener(`click`, () => {\n  resetForm();\n});\n\ndocument.addEventListener(`keydown`, (evt) => {\n  if (evt.key === window.utils.Key.ESCAPE && photoDescription !== document.activeElement && photoHashtags !== document.activeElement) {\n    evt.preventDefault();\n    resetForm();\n  }\n});\n\nscaleControlSmaller.addEventListener(`click`, () => {\n  getDownScale();\n});\n\nscaleControlBigger.addEventListener(`click`, () => {\n  getUpScale();\n});\n\nphotoHashtags.addEventListener(`input`, () => {\n  const validity = checkHashtags(photoHashtags.value);\n\n  if (validity.value) {\n    photoHashtags.classList.remove(`text__not-valid`);\n    photoHashtags.setCustomValidity(``);\n  } else {\n    photoHashtags.classList.add(`text__not-valid`);\n    switch (validity.reason) {\n      case `QUANTITY`:\n        photoHashtags.setCustomValidity(`Укажите не более ${HASHTAGS_MAX_QUANTITY} хэш-тегов`);\n        break;\n      case `RE`:\n        photoHashtags.setCustomValidity(`Каждый хэш-тег должен начинаться с символа # (решётка), может состоять из букв, чисел и _ (символ подчеркивания), хеш-тег не может состоять только из одной решётки, максимальная длина одного хэш-тега 20 символов, включая решётку`);\n        break;\n      case `DOUBLING`:\n        photoHashtags.setCustomValidity(`Один и тот же хэш-тег не может быть использован дважды, хэш-теги нечувствительны к регистру (#ХэшТег и #хэштег считаются одним и тем же тегом)`);\n        break;\n    }\n  }\n\n  photoHashtags.reportValidity();\n});\n\nphotoDescription.addEventListener(`input`, () => {\n  const valueLength = photoDescription.value.length;\n\n  if (valueLength > MAX_TITLE_LENGTH) {\n    const extraSymbols = valueLength - MAX_TITLE_LENGTH;\n\n    photoDescription.classList.add(`text__not-valid`);\n    photoDescription.setCustomValidity(`Допустимая длинна комментария - ${MAX_TITLE_LENGTH} символов. Удалите ${window.utils.getQEndings(extraSymbols, `symbol`)}`);\n  } else {\n    photoDescription.classList.remove(`text__not-valid`);\n    photoDescription.setCustomValidity(``);\n  }\n\n  photoDescription.reportValidity();\n});\n\nphotoUploadForm.addEventListener(`submit`, (evt) => {\n  evt.preventDefault();\n  window.backend.send(new FormData(photoUploadForm), onSendSuccess, onSendError);\n});\n","'use strict';\n\nconst filterPhotos = {\n  'filter-default': () => {\n    return window.photos;\n  },\n  'filter-random': () => {\n    return window.utils.getRandomArrayElements(window.photos, 10);\n  },\n  'filter-discussed': () => {\n    const copyPhotos = window.photos.slice();\n\n    return copyPhotos.sort((left, right) => {\n      return right.comments.length - left.comments.length;\n    });\n  },\n};\n\nconst filter = document.querySelector(`.img-filters__form`);\n\nconst onFilterFormChange = (evt) => {\n  filter.querySelector(`.img-filters__button--active`).classList.remove(`img-filters__button--active`);\n  evt.target.classList.add(`img-filters__button--active`);\n\n  window.pictures.renderPhotos(filterPhotos[evt.target.id]());\n};\n\nfilter.addEventListener(`click`, window.utils.debounce(onFilterFormChange));\n","'use strict';\n\nconst FILE_TYPES = [`gif`, `jpg`, `jpeg`, `png`];\n\nconst page = document.querySelector(`body`);\nconst photoUploadForm = document.querySelector(`.img-upload__form`);\nconst photoUploadFormInput = photoUploadForm.querySelector(`#upload-file`);\nconst photoPreview = photoUploadForm.querySelector(`.img-upload__preview img`);\nconst photoEditForm = photoUploadForm.querySelector(`.img-upload__overlay`);\nconst filter = document.querySelector(`.img-filters`);\n\nconst onLoadSuccess = (data) => {\n  window.photos = window.utils.addId(data);\n  window.pictures.renderPhotos(window.photos);\n  filter.classList.remove(`img-filters--inactive`);\n};\n\nconst onLoadError = (message) => {\n  const node = document.createElement(`div`);\n\n  node.classList.add(`on-error-message`);\n\n  node.textContent = message;\n  document.body.insertAdjacentElement(`afterbegin`, node);\n};\n\nconst onPhotoLoad = (evt) => {\n  const file = evt.target.files[0];\n\n  if (window.utils.checkExtensionAccordance(file, FILE_TYPES)) {\n    const reader = new FileReader();\n\n    reader.addEventListener(`load`, () => {\n      photoEditForm.classList.remove(`hidden`);\n      page.classList.add(`modal-open`);\n      photoPreview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n};\n\nwindow.backend.load(onLoadSuccess, onLoadError);\n\nphotoUploadFormInput.addEventListener(`change`, onPhotoLoad);\n"],"sourceRoot":""}